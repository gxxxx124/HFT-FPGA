# NASDAQ ITCH 5.0 协议消息结构解析

## 协议概述
NASDAQ ITCH 5.0 是纳斯达克交易所的二进制市场数据协议，用于实时传输股票订单簿更新、交易执行及系统事件。协议设计面向高频交易场景，支持低延迟数据处理。

---

## 通用消息头
所有消息的 **前 3 字节** 为公共头部：

| 偏移量 | 字段名         | 长度（字节） | 数据类型  | 描述                     |
|--------|----------------|-------------|-----------|--------------------------|
| 0      | **Msg Type**   | 1           | ASCII     | 消息类型标识符           |
| 1-2    | **Msg Length** | 2           | uint16    | 消息总长度（大端序）     |

---

## 核心消息类型及结构

### 1. Add Order (消息类型 `A`，0x41)
新增限价订单，触发订单簿更新。

| 偏移量 | 字段名            | 长度（字节） | 数据类型   | 描述                       | 
|--------|-------------------|-------------|------------|----------------------------|
| 3-4    | Stock Locate      | 2           | uint16     | 股票定位索引               
| 5-10   | Timestamp         | 6           | uint48     | 纳秒级时间戳               
| 11-18  | Order Reference # | 8           | uint64     | 订单唯一标识符             
| 19     | Buy/Sell          | 1           | char       | `B`=买 / `S`=卖           
| 20-23  | Shares            | 4           | uint32     | 订单数量                  
| 24-27  | Price             | 4           | uint32     | 价格（单位：0.0001 美元）  
| 28     | Attributes        | 1           | bitmask    | 订单属性（隐藏单等）       

---

### 2. Order Executed (消息类型 `E`，0x45)
订单部分或全部成交。

| 偏移量 | 字段名            | 长度（字节） | 数据类型   | 描述                       |
|--------|-------------------|-------------|------------|----------------------------|
| 3-4    | Stock Locate      | 2           | uint16     | 股票定位索引               |
| 5-10   | Timestamp         | 6           | uint48     | 纳秒级时间戳               |
| 11-18  | Order Reference # | 8           | uint64     | 被成交订单的标识符          |
| 19-26  | Executed Shares   | 8           | uint64     | 实际成交数量               |
| 27-34  | Execution ID      | 8           | uint64     | 成交事件唯一标识符          |



---

### 3. Stock Directory (消息类型 `R`，0x52)
定义股票代码与Stock Locate的映射关系。

| 偏移量 | 字段名            | 长度（字节） | 数据类型   | 描述                       |
|--------|-------------------|-------------|------------|----------------------------|
| 3-4    | Stock Locate      | 2           | uint16     | 股票定位索引               |
| 5-10   | Symbol            | 6           | char[6]    | 股票代码（如 `AAPL  `）     |
| 11     | Market Category   | 1           | char       | 市场分类（NASDAQ/NYSE等）  |



---

